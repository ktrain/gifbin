/** @jsx React.DOM */
var React = require('react');
var _ = require('lodash');

var queryVal;

var SearchBar = React.createClass({

	getDefaultProps: function() {
		return {
			onSearch : function(){}
		};
	},

	handleChange : function(e){
		this.props.onSearch(e.target.value);
		queryVal = e.target.value;
		this.updateUrl();
	},

	updateUrl : _.throttle(function(){
		var newUrl = window.location.protocol + "//" + document.location.host + document.location.pathname;
		if(queryVal){
			newUrl +="?q=" + queryVal;
		}
		window.history.replaceState(null,null,newUrl);
	}, 500),

	render : function(){
		var self = this;
		return(
			<div className='searchBar'>
				<input type='text' value={this.props.value} onChange={this.handleChange} />
			</div>
		);
	}
});

module.exports = SearchBar;
