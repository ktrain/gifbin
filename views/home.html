
<link rel="stylesheet" type="text/css" href="../style/home.css" />
<script type="text/javascript" src="../js/components/Searchbar.jsc"></script>

<script type="text/javascript" src="../js/views/GifCard.js"></script>
<script type="text/javascript" src="../js/views/LinkBtn.js"></script>
<script type="text/javascript" src="../js/views/SearchResults.js"></script>
<script type="text/javascript" src="../js/views/CategoryView.js"></script>

<title>gifbin.</title>

<div class='main content' style='min-height : 600px;'>
	<div class='categoryContainer'>
		<div class='title'>
			Categories
		</div>
	</div>
	<div class='searchContainer'></div>
</div>


<script>
	GifCategories.set(<%- categories %>);
	var gifs = GifCollection.create(<%- gifs %>);

	//Create Category view
	util.map(gifs.getCategoryBest(GifCategories), function(bestObj){
		CategoryView.create(bestObj).appendTo($('.categoryContainer'));
	});

	var searchBar = SearchbarComponent.create().prependTo($('.main'));
	var searchResults = SearchResults.create(gifs);
	searchResults.searchBar = searchBar;

	searchResults.appendTo($('.searchContainer'));
	searchResults.dom.view.hide();

	searchBar.on('searching', function(){
		 if($('.categoryContainer').is(':visible')) $('.categoryContainer').stop().fadeTo(300, 0.4);
	});
	searchBar.on('searched', function(terms){
		if(terms.length === 1 && terms[0] === ""){
			$('.categoryContainer').stop().fadeTo(100, 1);
			searchResults.dom.view.hide();
		} else {
			$('.categoryContainer').hide();
			searchResults.dom.view.stop().fadeTo(100, 1);
		}
		if($('.categoryContainer').is(':visible')) $('.categoryContainer').stop().fadeTo(100, 1);
	});
</script>
